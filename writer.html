<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Writer &mdash; FFPyPlayer 4.0.dev0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="FFPyPlayer 4.0.dev0 documentation" href="index.html" />
    <link rel="up" title="The FFPyPlayer API" href="api.html" />
    <link rel="next" title="Images" href="pic.html" />
    <link rel="prev" title="Player" href="player.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="writer">
<span id="writer-api"></span><h1>Writer<a class="headerlink" href="#writer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-ffpyplayer.writer">
<span id="ffpyplayer-writer"></span><h2><a class="reference internal" href="#module-ffpyplayer.writer" title="ffpyplayer.writer"><code class="xref py py-mod docutils literal"><span class="pre">ffpyplayer.writer</span></code></a><a class="headerlink" href="#module-ffpyplayer.writer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ffmpeg-based-media-writer">
<h3>FFmpeg based media writer<a class="headerlink" href="#ffmpeg-based-media-writer" title="Permalink to this headline">¶</a></h3>
<p>A FFmpeg based python media writer. See <a class="reference internal" href="#ffpyplayer.writer.MediaWriter" title="ffpyplayer.writer.MediaWriter"><code class="xref py py-class docutils literal"><span class="pre">MediaWriter</span></code></a> for details.
Currently writes only video.</p>
<dl class="class">
<dt id="ffpyplayer.writer.MediaWriter">
<em class="property">class </em><code class="descclassname">ffpyplayer.writer.</code><code class="descname">MediaWriter</code><a class="headerlink" href="#ffpyplayer.writer.MediaWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An FFmpeg based media writer class. Currently only supports video.</p>
<p>With this class one can write images frames stored in many different pixel
formats into a multi-stream video file using <a class="reference internal" href="#ffpyplayer.writer.MediaWriter.write_frame" title="ffpyplayer.writer.MediaWriter.write_frame"><code class="xref py py-meth docutils literal"><span class="pre">write_frame()</span></code></a>. All FFmpeg
codecs and pixel formats are supported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><cite>filename</cite>: str</dt>
<dd><p class="first last">The filename of the media file to create. Will be encoded using utf8
berfore passing to FFmpeg.</p>
</dd>
<dt><cite>streams</cite>: list of dicts</dt>
<dd><p class="first">A list of streams to create in the file. <code class="docutils literal"><span class="pre">streams</span></code>
is a list of dicts, where each dict configures the corresponding stream.
The keywords listed below are available. One can also specify default
values for the keywords for all streams using <code class="docutils literal"><span class="pre">kwargs</span></code>. Keywords also
found in <code class="docutils literal"><span class="pre">streams</span></code> will overwrite those in <code class="docutils literal"><span class="pre">kwargs</span></code>:</p>
<blockquote class="last">
<div><dl class="docutils">
<dt><cite>pix_fmt_in</cite>: str</dt>
<dd><p class="first last">The pixel format of the <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">Image</span></code></a>
to be passed to <a class="reference internal" href="#ffpyplayer.writer.MediaWriter.write_frame" title="ffpyplayer.writer.MediaWriter.write_frame"><code class="xref py py-meth docutils literal"><span class="pre">write_frame()</span></code></a> for this stream. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><code class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></code></a>.</p>
</dd>
<dt><cite>width_in</cite>: int</dt>
<dd><p class="first last">The width of the <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">ffpyplayer.pic.Image</span></code></a> that will be
passed to <a class="reference internal" href="#ffpyplayer.writer.MediaWriter.write_frame" title="ffpyplayer.writer.MediaWriter.write_frame"><code class="xref py py-meth docutils literal"><span class="pre">write_frame()</span></code></a> for this stream.</p>
</dd>
<dt><cite>height_in</cite>: int</dt>
<dd><p class="first last">The height of the <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">ffpyplayer.pic.Image</span></code></a> that will be
passed to <a class="reference internal" href="#ffpyplayer.writer.MediaWriter.write_frame" title="ffpyplayer.writer.MediaWriter.write_frame"><code class="xref py py-meth docutils literal"><span class="pre">write_frame()</span></code></a> for this stream.</p>
</dd>
<dt><cite>pix_fmt_out</cite>: str</dt>
<dd><p class="first last">The pixel format in which frames will be
written to the file for this stream. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><code class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></code></a>. Defaults to <code class="docutils literal"><span class="pre">pix_fmt_in</span></code>
if not provided. Not every pixel format is supported for each
encoding codec, see <a class="reference internal" href="tools.html#ffpyplayer.tools.get_supported_pixfmts" title="ffpyplayer.tools.get_supported_pixfmts"><code class="xref py py-func docutils literal"><span class="pre">get_supported_pixfmts()</span></code></a>
for which pixel formats are supported for <code class="docutils literal"><span class="pre">codec</span></code>.</p>
</dd>
<dt><cite>width_out</cite>: int</dt>
<dd><p class="first last">The width at which frames will be written to the file for this
stream. Defaults to <code class="docutils literal"><span class="pre">width_in</span></code> if not provided.</p>
</dd>
<dt><cite>height_out</cite>: int</dt>
<dd><p class="first last">The height at which frames will be written to the file for this
stream. Defaults to <code class="docutils literal"><span class="pre">height_in</span></code> if not provided.</p>
</dd>
<dt><cite>codec</cite>: str</dt>
<dd><p class="first">The codec used to write the frames to the file. Can be one of
the encoding codecs in <a class="reference internal" href="tools.html#ffpyplayer.tools.codecs_enc" title="ffpyplayer.tools.codecs_enc"><code class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.codecs_enc</span></code></a>.</p>
<p class="last">If not provided, it defaults to the default best codec for the format
provided in <code class="docutils literal"><span class="pre">fmt</span></code> or guessed from the <code class="docutils literal"><span class="pre">filename</span></code>.
See <code class="xref py py-func docutils literal"><span class="pre">ffpyplayer.tools.get_format_codecs()</span></code></p>
</dd>
<dt><cite>frame_rate</cite>: 2-tuple of ints</dt>
<dd><p class="first">A 2-tuple of ints representing the frame rate to be used when writing
the file. The first element is the numerator, while the second is the
denuminator of a ratio describing the rate. E.g. (2997, 100) describes
29.97 fps.</p>
<p class="last">The timestamps of the frames written using <a class="reference internal" href="#ffpyplayer.writer.MediaWriter.write_frame" title="ffpyplayer.writer.MediaWriter.write_frame"><code class="xref py py-meth docutils literal"><span class="pre">write_frame()</span></code></a> do
not necessarily need to be multiples of the frame rate because they might be
forced to matching timestamps if required. Not every frame rate is
supported for each encoding codec, see
<a class="reference internal" href="tools.html#ffpyplayer.tools.get_supported_framerates" title="ffpyplayer.tools.get_supported_framerates"><code class="xref py py-func docutils literal"><span class="pre">ffpyplayer.tools.get_supported_framerates()</span></code></a> for which frame
rates are supported for <code class="docutils literal"><span class="pre">codec</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><cite>fmt</cite>: str</dt>
<dd><p class="first last">The format to use for the output. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.formats_out" title="ffpyplayer.tools.formats_out"><code class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.formats_out</span></code></a>. Defaults to empty string.
If not provided, <code class="docutils literal"><span class="pre">filename</span></code> will be used determine the format,
otherwise this arg will be used.</p>
</dd>
<dt><cite>lib_opts</cite>: dict or list of dicts</dt>
<dd><p class="first last">A dictionary of options that will be passed
to the ffmpeg libraries, codecs, sws, and formats when opening them.
This accepts most of the options that can be passed to ffmpeg libraries.
See below for examples. Both the keywords and values must be strings.
It can be passed a dict in which case it&#8217;ll be applied to all the streams
or a list containing a dict for each stream.</p>
</dd>
<dt><cite>metadata</cite>: dict or list of dicts</dt>
<dd><p class="first last">Metadata that will be written to the streams, if
supported by the stream. See below for examples. Both the keywords and
values must be strings. It can be passed a dict in which case it&#8217;ll be
applied to all the streams or a list containing a dict for each stream.
If (these) metadata is not supported, it will silently fail to write them.</p>
</dd>
<dt><cite>overwrite</cite>: bool</dt>
<dd><p class="first last">Whether we should overwrite an existing file.
If False, an error will be raised if the file already exists. If True,
the file will be overwritten if it exists.</p>
</dd>
<dt><cite>**kwargs</cite>:</dt>
<dd><p class="first last">Accepts default values for all <code class="docutils literal"><span class="pre">streams</span></code> which will be used if these
keywords are not provided for any stream.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="examples.html#write-simple"><span>Writing video to file</span></a> and <a class="reference internal" href="examples.html#write-h264"><span>Compressing video to h264</span></a> for examples.</p>
<dl class="method">
<dt id="ffpyplayer.writer.MediaWriter.close">
<code class="descname">close</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#ffpyplayer.writer.MediaWriter.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the writer and writes any frames cached and not yet written.</p>
<p>Until called, or until the instance is deleted (and this is implicitly called)
the file is not fully written.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">After calling this method, calling any other class method on this instance may
result in a crash or program corruption.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.writer.MediaWriter.get_configuration">
<code class="descname">get_configuration</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#ffpyplayer.writer.MediaWriter.get_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the configuration parameters used to initialize all the streams for this
instance.</p>
<p>This is not the same as the dicts passed when creating the file because
this uses the actual parameters used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list: List of dicts for each stream.</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ffpyplayer.writer</span> <span class="kn">import</span> <span class="n">MediaWriter</span>

<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">480</span>
<span class="n">out_opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pix_fmt_in&#39;</span><span class="p">:</span><span class="s1">&#39;rgb24&#39;</span><span class="p">,</span> <span class="s1">&#39;width_in&#39;</span><span class="p">:</span><span class="n">w</span><span class="p">,</span> <span class="s1">&#39;height_in&#39;</span><span class="p">:</span><span class="n">h</span><span class="p">,</span> <span class="s1">&#39;codec&#39;</span><span class="p">:</span><span class="s1">&#39;rawvideo&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frame_rate&#39;</span><span class="p">:(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">MediaWriter</span><span class="p">(</span><span class="s1">&#39;output.avi&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">out_opts</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width_out</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_out</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span> <span class="n">writer</span><span class="o">.</span><span class="n">get_configuration</span><span class="p">()</span>
<span class="p">[{</span><span class="s1">&#39;height_in&#39;</span><span class="p">:</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;codec&#39;</span><span class="p">:</span> <span class="s1">&#39;rawvideo&#39;</span><span class="p">,</span> <span class="s1">&#39;width_in&#39;</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;frame_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="s1">&#39;pix_fmt_in&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb24&#39;</span><span class="p">,</span> <span class="s1">&#39;width_out&#39;</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="s1">&#39;height_out&#39;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span> <span class="s1">&#39;pix_fmt_out&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb24&#39;</span><span class="p">},</span>
<span class="p">{</span><span class="s1">&#39;height_in&#39;</span><span class="p">:</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;codec&#39;</span><span class="p">:</span> <span class="s1">&#39;rawvideo&#39;</span><span class="p">,</span> <span class="s1">&#39;width_in&#39;</span><span class="p">:</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;frame_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="s1">&#39;pix_fmt_in&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb24&#39;</span><span class="p">,</span> <span class="s1">&#39;width_out&#39;</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="s1">&#39;height_out&#39;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span> <span class="s1">&#39;pix_fmt_out&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb24&#39;</span><span class="p">}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.writer.MediaWriter.write_frame">
<code class="descname">write_frame</code><span class="sig-paren">(</span><em>self</em>, <em>Image img</em>, <em>double pts</em>, <em>int stream=0</em><span class="sig-paren">)</span><a class="headerlink" href="#ffpyplayer.writer.MediaWriter.write_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">ffpyplayer.pic.Image</span></code></a> frame to the specified stream.</p>
<p>If the input data is different than the frame written to disk in either
size or pixel format as specified when creating the stream, the frame
is converted before writing. But the input image must match the size and
format as that specified when creating this stream.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><cite>img</cite>: <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">ffpyplayer.pic.Image</span></code></a></dt>
<dd><p class="first last">The <a class="reference internal" href="pic.html#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><code class="xref py py-class docutils literal"><span class="pre">ffpyplayer.pic.Image</span></code></a> instance containing the frame
to be written to disk.</p>
</dd>
<dt><cite>pts</cite>: float</dt>
<dd><p class="first last">The timestamp of this frame in video time. E.g. 0.5
means the frame should be displayed by a player at 0.5 seconds after
the video started playing. In a sense, the frame rate defines which
timestamps are valid timestamps. However, this is not always the
case, so if timestamps are invalid for a particular format, they are
forced to valid values, if possible.</p>
</dd>
<dt><cite>stream</cite>: int</dt>
<dd><p class="first last">The stream number to which to write this frame. Defaults to 0.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>(int): The approximate number of bytes written to disk so far for this file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is not the same as the number of bytes passed to this function
so far, because the encoders cache data before writing to disk.
So although some frames may have been passed, the return value
may not represent this.</p>
<p class="last">An extreme example is where the same frame is passed many times
to h264; the encoder will only write this frame once when the Writer
object is closed and encoders are flushed, so this function
will only return 0.</p>
</div>
</p>
</td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="examples.html#examples"><span>Examples</span></a> for its usage.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">FFPyPlayer</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=matham&repo=ffpyplayer&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">The FFPyPlayer API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="player.html">Player</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Writer</a></li>
<li class="toctree-l2"><a class="reference internal" href="pic.html">Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">The FFPyPlayer API</a><ul>
      <li>Previous: <a href="player.html" title="previous chapter">Player</a></li>
      <li>Next: <a href="pic.html" title="next chapter">Images</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/writer.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2013, Matthew Einhorn.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/writer.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/matham/ffpyplayer" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>